<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,intitial-scale=1,maximum-scale=1">
    <script type="text/javascript" src="JS/jquery-1.12.2.min.js"></script>
    <script type="text/javascript" src="JS/fdb-all.min.js"></script>
    <script type="text/javascript" src="JS/bootstrap.min.js"></script>
    <link href="CSS/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
    <h1 style="text-align:center">支出查詢</h1>
    <input type="radio" name="month" style="margin-left:5%">
    本月份
    <br>
    <input type="radio" name="month" style="margin-left:5%">
    指定月份
    <br>
    <input type="date" style="margin-left:5%">
    ~
    <input type="date">
    <button id="check" class="btn btn-primary" style="width:70%;margin-left:5%">查詢</button>
    <table class="table table-striped">
      <thead>
        <tr>
          <td>類別</td>
          <td>金額</td>
          <td>比例</td>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
        <table class="table table-striped" id="on">
      <thead>
        <tr>
          <td>日期</td>
          <td>事項</td>
          <td>金額</td>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    <script>
      var fdb = new ForerunnerDB();
      var db = fdb.db("expenses");
      var expensesCollection = db.collection('expenses');
      var date = new Date();
      var year = date.getFullYear();
      var month = date.getMonth()+1;
      var date = date.getDate();
      if(month<10){
        month = "0"+month;
      }
      if(date<10){
        date = "0"+date;
      }
      console.log(year+"-"+month+"-01");
      expensesCollection.load(function(){
        $("#check").click(function(){
          var result = expensesCollection.find({
            time:{
              $lte: year+"-"+month+"-"+date,
              $gte: year+"-"+month+"-01"
            },
            {$orderBy:{time:-1}}
          });
          console.log(result);
        });
        for(var i= 0:i<result.length:i++){
          $("#on").append(
            "<tr><td>"+result[i].time+
            "</td><td>"+result[i].thing+
            "</td><td>"+result[i].money+
            "</td></tr>"
            )
        }
      })
    </script>
  </body>
</html>
